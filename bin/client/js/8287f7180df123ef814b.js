"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[603],{5927:(t,e,s)=>{s.d(e,{c:()=>n,o:()=>h});var r=s(4296),i=s(6469),o=s(2876),a=s(521),n=function(){function t(t,e,s){void 0===s&&(s=null),this._texture=t instanceof i.xE?t:null,this.baseTexture=t instanceof i.VL?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(s||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,s=(0,o.getResolutionOfUrl)(t,null);return null===s&&(s=void 0!==e?parseFloat(e):1),1!==s&&this.baseTexture.setResolution(s),s},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var s=e,o=t.BATCH_SIZE;s-e<o&&s<this._frameKeys.length;){var a=this._frameKeys[s],n=this._frames[a],h=n.frame;if(h){var u,l=null,c=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,f=new r.Ae(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);u=n.rotated?new r.Ae(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new r.Ae(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(l=new r.Ae(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[a]=new i.xE(this.baseTexture,u,f,l,n.rotated?2:0,n.anchor),i.xE.addToCache(this.textures[a],a)}s++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var s=0;s<t[e].length;s++){var r=t[e][s];this.animations[e].push(this.textures[r])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var s in void 0===t&&(t=!1),this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}(),h=function(){function t(){}return t.use=function(e,s){var r=this,i=e.name+"_image";if(e.data&&e.type===a.kC.TYPE.JSON&&e.data.frames&&!r.resources[i]){var o={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},h=t.getResourcePath(e,r.baseUrl);r.add(i,h,o,(function(t){if(t.error)s(t.error);else{var r=new n(t.texture,e.data,e.url);r.parse((function(){e.spritesheet=r,e.textures=r.textures,s()}))}}))}else s()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:o.url.resolve(t.url.replace(e,""),t.data.meta.image)},t}()}}]);