{"version":3,"file":"js/d63f7a50b3caa8838ee5.js","mappings":"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","sources":["webpack:///../../node_modules/resource-loader/dist/resource-loader.esm.js"],"sourcesContent":["/*!\n * resource-loader - v3.0.1\n * https://github.com/pixijs/pixi-sound\n * Compiled Tue, 02 Jul 2019 14:06:18 UTC\n *\n * resource-loader is licensed under the MIT license.\n * http://www.opensource.org/licenses/mit-license\n */\nimport parseUri from 'parse-uri';\nimport Signal from 'mini-signals';\n\n/**\n * Smaller version of the async library constructs.\n *\n * @namespace async\n */\n\n/**\n * Noop function\n *\n * @ignore\n * @function\n * @memberof async\n */\nfunction _noop() {}\n/* empty */\n\n/**\n * Iterates an array in series.\n *\n * @memberof async\n * @function eachSeries\n * @param {Array.<*>} array - Array to iterate.\n * @param {function} iterator - Function to call for each element.\n * @param {function} callback - Function to call when done, or on error.\n * @param {boolean} [deferNext=false] - Break synchronous each loop by calling next with a setTimeout of 1.\n */\n\n\nfunction eachSeries(array, iterator, callback, deferNext) {\n  var i = 0;\n  var len = array.length;\n\n  (function next(err) {\n    if (err || i === len) {\n      if (callback) {\n        callback(err);\n      }\n\n      return;\n    }\n\n    if (deferNext) {\n      setTimeout(function () {\n        iterator(array[i++], next);\n      }, 1);\n    } else {\n      iterator(array[i++], next);\n    }\n  })();\n}\n/**\n * Ensures a function is only called once.\n *\n * @ignore\n * @memberof async\n * @param {function} fn - The function to wrap.\n * @return {function} The wrapping function.\n */\n\nfunction onlyOnce(fn) {\n  return function onceWrapper() {\n    if (fn === null) {\n      throw new Error('Callback was already called.');\n    }\n\n    var callFn = fn;\n    fn = null;\n    callFn.apply(this, arguments);\n  };\n}\n/**\n * Async queue implementation,\n *\n * @memberof async\n * @function queue\n * @param {function} worker - The worker function to call for each task.\n * @param {number} concurrency - How many workers to run in parrallel.\n * @return {*} The async queue object.\n */\n\n\nfunction queue(worker, concurrency) {\n  if (concurrency == null) {\n    // eslint-disable-line no-eq-null,eqeqeq\n    concurrency = 1;\n  } else if (concurrency === 0) {\n    throw new Error('Concurrency must not be zero');\n  }\n\n  var workers = 0;\n  var q = {\n    _tasks: [],\n    concurrency: concurrency,\n    saturated: _noop,\n    unsaturated: _noop,\n    buffer: concurrency / 4,\n    empty: _noop,\n    drain: _noop,\n    error: _noop,\n    started: false,\n    paused: false,\n    push: function push(data, callback) {\n      _insert(data, false, callback);\n    },\n    kill: function kill() {\n      workers = 0;\n      q.drain = _noop;\n      q.started = false;\n      q._tasks = [];\n    },\n    unshift: function unshift(data, callback) {\n      _insert(data, true, callback);\n    },\n    process: function process() {\n      while (!q.paused && workers < q.concurrency && q._tasks.length) {\n        var task = q._tasks.shift();\n\n        if (q._tasks.length === 0) {\n          q.empty();\n        }\n\n        workers += 1;\n\n        if (workers === q.concurrency) {\n          q.saturated();\n        }\n\n        worker(task.data, onlyOnce(_next(task)));\n      }\n    },\n    length: function length() {\n      return q._tasks.length;\n    },\n    running: function running() {\n      return workers;\n    },\n    idle: function idle() {\n      return q._tasks.length + workers === 0;\n    },\n    pause: function pause() {\n      if (q.paused === true) {\n        return;\n      }\n\n      q.paused = true;\n    },\n    resume: function resume() {\n      if (q.paused === false) {\n        return;\n      }\n\n      q.paused = false; // Need to call q.process once per concurrent\n      // worker to preserve full concurrency after pause\n\n      for (var w = 1; w <= q.concurrency; w++) {\n        q.process();\n      }\n    }\n  };\n\n  function _insert(data, insertAtFront, callback) {\n    if (callback != null && typeof callback !== 'function') {\n      // eslint-disable-line no-eq-null,eqeqeq\n      throw new Error('task callback must be a function');\n    }\n\n    q.started = true;\n\n    if (data == null && q.idle()) {\n      // eslint-disable-line no-eq-null,eqeqeq\n      // call drain immediately if there are no tasks\n      setTimeout(function () {\n        return q.drain();\n      }, 1);\n      return;\n    }\n\n    var item = {\n      data: data,\n      callback: typeof callback === 'function' ? callback : _noop\n    };\n\n    if (insertAtFront) {\n      q._tasks.unshift(item);\n    } else {\n      q._tasks.push(item);\n    }\n\n    setTimeout(function () {\n      return q.process();\n    }, 1);\n  }\n\n  function _next(task) {\n    return function next() {\n      workers -= 1;\n      task.callback.apply(task, arguments);\n\n      if (arguments[0] != null) {\n        // eslint-disable-line no-eq-null,eqeqeq\n        q.error(arguments[0], task.data);\n      }\n\n      if (workers <= q.concurrency - q.buffer) {\n        q.unsaturated();\n      }\n\n      if (q.idle()) {\n        q.drain();\n      }\n\n      q.process();\n    };\n  }\n\n  return q;\n}\n\nvar async = ({\n    eachSeries: eachSeries,\n    queue: queue\n});\n\n// a simple in-memory cache for resources\nvar cache = {};\n/**\n * A simple in-memory cache for resource.\n *\n * @memberof middleware\n * @function caching\n * @example\n * import { Loader, middleware } from 'resource-loader';\n * const loader = new Loader();\n * loader.use(middleware.caching);\n * @param {Resource} resource - Current Resource\n * @param {function} next - Callback when complete\n */\n\nfunction caching(resource, next) {\n  var _this = this;\n\n  // if cached, then set data and complete the resource\n  if (cache[resource.url]) {\n    resource.data = cache[resource.url];\n    resource.complete(); // marks resource load complete and stops processing before middlewares\n  } // if not cached, wait for complete and store it in the cache.\n  else {\n      resource.onComplete.once(function () {\n        return cache[_this.url] = _this.data;\n      });\n    }\n\n  next();\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar useXdr = !!(window.XDomainRequest && !('withCredentials' in new XMLHttpRequest()));\nvar tempAnchor = null; // some status constants\n\nvar STATUS_NONE = 0;\nvar STATUS_OK = 200;\nvar STATUS_EMPTY = 204;\nvar STATUS_IE_BUG_EMPTY = 1223;\nvar STATUS_TYPE_OK = 2; // noop\n\nfunction _noop$1() {}\n/* empty */\n\n/**\n * Manages the state and loading of a resource and all child resources.\n *\n * @class\n */\n\n\nvar Resource =\n/*#__PURE__*/\nfunction () {\n  /**\n   * Sets the load type to be used for a specific extension.\n   *\n   * @static\n   * @param {string} extname - The extension to set the type for, e.g. \"png\" or \"fnt\"\n   * @param {Resource.LOAD_TYPE} loadType - The load type to set it to.\n   */\n  Resource.setExtensionLoadType = function setExtensionLoadType(extname, loadType) {\n    setExtMap(Resource._loadTypeMap, extname, loadType);\n  }\n  /**\n   * Sets the load type to be used for a specific extension.\n   *\n   * @static\n   * @param {string} extname - The extension to set the type for, e.g. \"png\" or \"fnt\"\n   * @param {Resource.XHR_RESPONSE_TYPE} xhrType - The xhr type to set it to.\n   */\n  ;\n\n  Resource.setExtensionXhrType = function setExtensionXhrType(extname, xhrType) {\n    setExtMap(Resource._xhrTypeMap, extname, xhrType);\n  }\n  /**\n   * @param {string} name - The name of the resource to load.\n   * @param {string|string[]} url - The url for this resource, for audio/video loads you can pass\n   *      an array of sources.\n   * @param {object} [options] - The options for the load.\n   * @param {string|boolean} [options.crossOrigin] - Is this request cross-origin? Default is to\n   *      determine automatically.\n   * @param {number} [options.timeout=0] - A timeout in milliseconds for the load. If the load takes\n   *      longer than this time it is cancelled and the load is considered a failure. If this value is\n   *      set to `0` then there is no explicit timeout.\n   * @param {Resource.LOAD_TYPE} [options.loadType=Resource.LOAD_TYPE.XHR] - How should this resource\n   *      be loaded?\n   * @param {Resource.XHR_RESPONSE_TYPE} [options.xhrType=Resource.XHR_RESPONSE_TYPE.DEFAULT] - How\n   *      should the data being loaded be interpreted when using XHR?\n   * @param {Resource.IMetadata} [options.metadata] - Extra configuration for middleware and the Resource object.\n   */\n  ;\n\n  function Resource(name, url, options) {\n    if (typeof name !== 'string' || typeof url !== 'string') {\n      throw new Error('Both name and url are required for constructing a resource.');\n    }\n\n    options = options || {};\n    /**\n     * The state flags of this resource.\n     *\n     * @private\n     * @member {number}\n     */\n\n    this._flags = 0; // set data url flag, needs to be set early for some _determineX checks to work.\n\n    this._setFlag(Resource.STATUS_FLAGS.DATA_URL, url.indexOf('data:') === 0);\n    /**\n     * The name of this resource.\n     *\n     * @readonly\n     * @member {string}\n     */\n\n\n    this.name = name;\n    /**\n     * The url used to load this resource.\n     *\n     * @readonly\n     * @member {string}\n     */\n\n    this.url = url;\n    /**\n     * The extension used to load this resource.\n     *\n     * @readonly\n     * @member {string}\n     */\n\n    this.extension = this._getExtension();\n    /**\n     * The data that was loaded by the resource.\n     *\n     * @member {any}\n     */\n\n    this.data = null;\n    /**\n     * Is this request cross-origin? If unset, determined automatically.\n     *\n     * @member {string}\n     */\n\n    this.crossOrigin = options.crossOrigin === true ? 'anonymous' : options.crossOrigin;\n    /**\n     * A timeout in milliseconds for the load. If the load takes longer than this time\n     * it is cancelled and the load is considered a failure. If this value is set to `0`\n     * then there is no explicit timeout.\n     *\n     * @member {number}\n     */\n\n    this.timeout = options.timeout || 0;\n    /**\n     * The method of loading to use for this resource.\n     *\n     * @member {Resource.LOAD_TYPE}\n     */\n\n    this.loadType = options.loadType || this._determineLoadType();\n    /**\n     * The type used to load the resource via XHR. If unset, determined automatically.\n     *\n     * @member {string}\n     */\n\n    this.xhrType = options.xhrType;\n    /**\n     * Extra info for middleware, and controlling specifics about how the resource loads.\n     *\n     * Note that if you pass in a `loadElement`, the Resource class takes ownership of it.\n     * Meaning it will modify it as it sees fit.\n     *\n     * @member {Resource.IMetadata}\n     */\n\n    this.metadata = options.metadata || {};\n    /**\n     * The error that occurred while loading (if any).\n     *\n     * @readonly\n     * @member {Error}\n     */\n\n    this.error = null;\n    /**\n     * The XHR object that was used to load this resource. This is only set\n     * when `loadType` is `Resource.LOAD_TYPE.XHR`.\n     *\n     * @readonly\n     * @member {XMLHttpRequest}\n     */\n\n    this.xhr = null;\n    /**\n     * The child resources this resource owns.\n     *\n     * @readonly\n     * @member {Resource[]}\n     */\n\n    this.children = [];\n    /**\n     * The resource type.\n     *\n     * @readonly\n     * @member {Resource.TYPE}\n     */\n\n    this.type = Resource.TYPE.UNKNOWN;\n    /**\n     * The progress chunk owned by this resource.\n     *\n     * @readonly\n     * @member {number}\n     */\n\n    this.progressChunk = 0;\n    /**\n     * The `dequeue` method that will be used a storage place for the async queue dequeue method\n     * used privately by the loader.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._dequeue = _noop$1;\n    /**\n     * Used a storage place for the on load binding used privately by the loader.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._onLoadBinding = null;\n    /**\n     * The timer for element loads to check if they timeout.\n     *\n     * @private\n     * @member {number}\n     */\n\n    this._elementTimer = 0;\n    /**\n     * The `complete` function bound to this resource's context.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._boundComplete = this.complete.bind(this);\n    /**\n     * The `_onError` function bound to this resource's context.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._boundOnError = this._onError.bind(this);\n    /**\n     * The `_onProgress` function bound to this resource's context.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._boundOnProgress = this._onProgress.bind(this);\n    /**\n     * The `_onTimeout` function bound to this resource's context.\n     *\n     * @private\n     * @member {function}\n     */\n\n    this._boundOnTimeout = this._onTimeout.bind(this); // xhr callbacks\n\n    this._boundXhrOnError = this._xhrOnError.bind(this);\n    this._boundXhrOnTimeout = this._xhrOnTimeout.bind(this);\n    this._boundXhrOnAbort = this._xhrOnAbort.bind(this);\n    this._boundXhrOnLoad = this._xhrOnLoad.bind(this);\n    /**\n     * Dispatched when the resource beings to load.\n     *\n     * The callback looks like {@link Resource.OnStartSignal}.\n     *\n     * @member {Signal<Resource.OnStartSignal>}\n     */\n\n    this.onStart = new Signal();\n    /**\n     * Dispatched each time progress of this resource load updates.\n     * Not all resources types and loader systems can support this event\n     * so sometimes it may not be available. If the resource\n     * is being loaded on a modern browser, using XHR, and the remote server\n     * properly sets Content-Length headers, then this will be available.\n     *\n     * The callback looks like {@link Resource.OnProgressSignal}.\n     *\n     * @member {Signal<Resource.OnProgressSignal>}\n     */\n\n    this.onProgress = new Signal();\n    /**\n     * Dispatched once this resource has loaded, if there was an error it will\n     * be in the `error` property.\n     *\n     * The callback looks like {@link Resource.OnCompleteSignal}.\n     *\n     * @member {Signal<Resource.OnCompleteSignal>}\n     */\n\n    this.onComplete = new Signal();\n    /**\n     * Dispatched after this resource has had all the *after* middleware run on it.\n     *\n     * The callback looks like {@link Resource.OnCompleteSignal}.\n     *\n     * @member {Signal<Resource.OnCompleteSignal>}\n     */\n\n    this.onAfterMiddleware = new Signal();\n  }\n  /**\n   * When the resource starts to load.\n   *\n   * @memberof Resource\n   * @callback OnStartSignal\n   * @param {Resource} resource - The resource that the event happened on.\n   */\n\n  /**\n   * When the resource reports loading progress.\n   *\n   * @memberof Resource\n   * @callback OnProgressSignal\n   * @param {Resource} resource - The resource that the event happened on.\n   * @param {number} percentage - The progress of the load in the range [0, 1].\n   */\n\n  /**\n   * When the resource finishes loading.\n   *\n   * @memberof Resource\n   * @callback OnCompleteSignal\n   * @param {Resource} resource - The resource that the event happened on.\n   */\n\n  /**\n   * @memberof Resource\n   * @typedef {object} IMetadata\n   * @property {HTMLImageElement|HTMLAudioElement|HTMLVideoElement} [loadElement=null] - The\n   *      element to use for loading, instead of creating one.\n   * @property {boolean} [skipSource=false] - Skips adding source(s) to the load element. This\n   *      is useful if you want to pass in a `loadElement` that you already added load sources to.\n   * @property {string|string[]} [mimeType] - The mime type to use for the source element\n   *      of a video/audio elment. If the urls are an array, you can pass this as an array as well\n   *      where each index is the mime type to use for the corresponding url index.\n   */\n\n  /**\n   * Stores whether or not this url is a data url.\n   *\n   * @readonly\n   * @member {boolean}\n   */\n\n\n  var _proto = Resource.prototype;\n\n  /**\n   * Marks the resource as complete.\n   *\n   */\n  _proto.complete = function complete() {\n    this._clearEvents();\n\n    this._finish();\n  }\n  /**\n   * Aborts the loading of this resource, with an optional message.\n   *\n   * @param {string} message - The message to use for the error\n   */\n  ;\n\n  _proto.abort = function abort(message) {\n    // abort can be called multiple times, ignore subsequent calls.\n    if (this.error) {\n      return;\n    } // store error\n\n\n    this.error = new Error(message); // clear events before calling aborts\n\n    this._clearEvents(); // abort the actual loading\n\n\n    if (this.xhr) {\n      this.xhr.abort();\n    } else if (this.xdr) {\n      this.xdr.abort();\n    } else if (this.data) {\n      // single source\n      if (this.data.src) {\n        this.data.src = Resource.EMPTY_GIF;\n      } // multi-source\n      else {\n          while (this.data.firstChild) {\n            this.data.removeChild(this.data.firstChild);\n          }\n        }\n    } // done now.\n\n\n    this._finish();\n  }\n  /**\n   * Kicks off loading of this resource. This method is asynchronous.\n   *\n   * @param {Resource.OnCompleteSignal} [cb] - Optional callback to call once the resource is loaded.\n   */\n  ;\n\n  _proto.load = function load(cb) {\n    var _this = this;\n\n    if (this.isLoading) {\n      return;\n    }\n\n    if (this.isComplete) {\n      if (cb) {\n        setTimeout(function () {\n          return cb(_this);\n        }, 1);\n      }\n\n      return;\n    } else if (cb) {\n      this.onComplete.once(cb);\n    }\n\n    this._setFlag(Resource.STATUS_FLAGS.LOADING, true);\n\n    this.onStart.dispatch(this); // if unset, determine the value\n\n    if (this.crossOrigin === false || typeof this.crossOrigin !== 'string') {\n      this.crossOrigin = this._determineCrossOrigin(this.url);\n    }\n\n    switch (this.loadType) {\n      case Resource.LOAD_TYPE.IMAGE:\n        this.type = Resource.TYPE.IMAGE;\n\n        this._loadElement('image');\n\n        break;\n\n      case Resource.LOAD_TYPE.AUDIO:\n        this.type = Resource.TYPE.AUDIO;\n\n        this._loadSourceElement('audio');\n\n        break;\n\n      case Resource.LOAD_TYPE.VIDEO:\n        this.type = Resource.TYPE.VIDEO;\n\n        this._loadSourceElement('video');\n\n        break;\n\n      case Resource.LOAD_TYPE.XHR:\n      /* falls through */\n\n      default:\n        if (useXdr && this.crossOrigin) {\n          this._loadXdr();\n        } else {\n          this._loadXhr();\n        }\n\n        break;\n    }\n  }\n  /**\n   * Checks if the flag is set.\n   *\n   * @private\n   * @param {number} flag - The flag to check.\n   * @return {boolean} True if the flag is set.\n   */\n  ;\n\n  _proto._hasFlag = function _hasFlag(flag) {\n    return (this._flags & flag) !== 0;\n  }\n  /**\n   * (Un)Sets the flag.\n   *\n   * @private\n   * @param {number} flag - The flag to (un)set.\n   * @param {boolean} value - Whether to set or (un)set the flag.\n   */\n  ;\n\n  _proto._setFlag = function _setFlag(flag, value) {\n    this._flags = value ? this._flags | flag : this._flags & ~flag;\n  }\n  /**\n   * Clears all the events from the underlying loading source.\n   *\n   * @private\n   */\n  ;\n\n  _proto._clearEvents = function _clearEvents() {\n    clearTimeout(this._elementTimer);\n\n    if (this.data && this.data.removeEventListener) {\n      this.data.removeEventListener('error', this._boundOnError, false);\n      this.data.removeEventListener('load', this._boundComplete, false);\n      this.data.removeEventListener('progress', this._boundOnProgress, false);\n      this.data.removeEventListener('canplaythrough', this._boundComplete, false);\n    }\n\n    if (this.xhr) {\n      if (this.xhr.removeEventListener) {\n        this.xhr.removeEventListener('error', this._boundXhrOnError, false);\n        this.xhr.removeEventListener('timeout', this._boundXhrOnTimeout, false);\n        this.xhr.removeEventListener('abort', this._boundXhrOnAbort, false);\n        this.xhr.removeEventListener('progress', this._boundOnProgress, false);\n        this.xhr.removeEventListener('load', this._boundXhrOnLoad, false);\n      } else {\n        this.xhr.onerror = null;\n        this.xhr.ontimeout = null;\n        this.xhr.onprogress = null;\n        this.xhr.onload = null;\n      }\n    }\n  }\n  /**\n   * Finalizes the load.\n   *\n   * @private\n   */\n  ;\n\n  _proto._finish = function _finish() {\n    if (this.isComplete) {\n      throw new Error('Complete called again for an already completed resource.');\n    }\n\n    this._setFlag(Resource.STATUS_FLAGS.COMPLETE, true);\n\n    this._setFlag(Resource.STATUS_FLAGS.LOADING, false);\n\n    this.onComplete.dispatch(this);\n  }\n  /**\n   * Loads this resources using an element that has a single source,\n   * like an HTMLImageElement.\n   *\n   * @private\n   * @param {string} type - The type of element to use.\n   */\n  ;\n\n  _proto._loadElement = function _loadElement(type) {\n    if (this.metadata.loadElement) {\n      this.data = this.metadata.loadElement;\n    } else if (type === 'image' && typeof window.Image !== 'undefined') {\n      this.data = new Image();\n    } else {\n      this.data = document.createElement(type);\n    }\n\n    if (this.crossOrigin) {\n      this.data.crossOrigin = this.crossOrigin;\n    }\n\n    if (!this.metadata.skipSource) {\n      this.data.src = this.url;\n    }\n\n    this.data.addEventListener('error', this._boundOnError, false);\n    this.data.addEventListener('load', this._boundComplete, false);\n    this.data.addEventListener('progress', this._boundOnProgress, false);\n\n    if (this.timeout) {\n      this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout);\n    }\n  }\n  /**\n   * Loads this resources using an element that has multiple sources,\n   * like an HTMLAudioElement or HTMLVideoElement.\n   *\n   * @private\n   * @param {string} type - The type of element to use.\n   */\n  ;\n\n  _proto._loadSourceElement = function _loadSourceElement(type) {\n    if (this.metadata.loadElement) {\n      this.data = this.metadata.loadElement;\n    } else if (type === 'audio' && typeof window.Audio !== 'undefined') {\n      this.data = new Audio();\n    } else {\n      this.data = document.createElement(type);\n    }\n\n    if (this.data === null) {\n      this.abort(\"Unsupported element: \" + type);\n      return;\n    }\n\n    if (this.crossOrigin) {\n      this.data.crossOrigin = this.crossOrigin;\n    }\n\n    if (!this.metadata.skipSource) {\n      // support for CocoonJS Canvas+ runtime, lacks document.createElement('source')\n      if (navigator.isCocoonJS) {\n        this.data.src = Array.isArray(this.url) ? this.url[0] : this.url;\n      } else if (Array.isArray(this.url)) {\n        var mimeTypes = this.metadata.mimeType;\n\n        for (var i = 0; i < this.url.length; ++i) {\n          this.data.appendChild(this._createSource(type, this.url[i], Array.isArray(mimeTypes) ? mimeTypes[i] : mimeTypes));\n        }\n      } else {\n        var _mimeTypes = this.metadata.mimeType;\n        this.data.appendChild(this._createSource(type, this.url, Array.isArray(_mimeTypes) ? _mimeTypes[0] : _mimeTypes));\n      }\n    }\n\n    this.data.addEventListener('error', this._boundOnError, false);\n    this.data.addEventListener('load', this._boundComplete, false);\n    this.data.addEventListener('progress', this._boundOnProgress, false);\n    this.data.addEventListener('canplaythrough', this._boundComplete, false);\n    this.data.load();\n\n    if (this.timeout) {\n      this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout);\n    }\n  }\n  /**\n   * Loads this resources using an XMLHttpRequest.\n   *\n   * @private\n   */\n  ;\n\n  _proto._loadXhr = function _loadXhr() {\n    // if unset, determine the value\n    if (typeof this.xhrType !== 'string') {\n      this.xhrType = this._determineXhrType();\n    }\n\n    var xhr = this.xhr = new XMLHttpRequest(); // set the request type and url\n\n    xhr.open('GET', this.url, true);\n    xhr.timeout = this.timeout; // load json as text and parse it ourselves. We do this because some browsers\n    // *cough* safari *cough* can't deal with it.\n\n    if (this.xhrType === Resource.XHR_RESPONSE_TYPE.JSON || this.xhrType === Resource.XHR_RESPONSE_TYPE.DOCUMENT) {\n      xhr.responseType = Resource.XHR_RESPONSE_TYPE.TEXT;\n    } else {\n      xhr.responseType = this.xhrType;\n    }\n\n    xhr.addEventListener('error', this._boundXhrOnError, false);\n    xhr.addEventListener('timeout', this._boundXhrOnTimeout, false);\n    xhr.addEventListener('abort', this._boundXhrOnAbort, false);\n    xhr.addEventListener('progress', this._boundOnProgress, false);\n    xhr.addEventListener('load', this._boundXhrOnLoad, false);\n    xhr.send();\n  }\n  /**\n   * Loads this resources using an XDomainRequest. This is here because we need to support IE9 (gross).\n   *\n   * @private\n   */\n  ;\n\n  _proto._loadXdr = function _loadXdr() {\n    // if unset, determine the value\n    if (typeof this.xhrType !== 'string') {\n      this.xhrType = this._determineXhrType();\n    }\n\n    var xdr = this.xhr = new XDomainRequest(); // eslint-disable-line no-undef\n    // XDomainRequest has a few quirks. Occasionally it will abort requests\n    // A way to avoid this is to make sure ALL callbacks are set even if not used\n    // More info here: http://stackoverflow.com/questions/15786966/xdomainrequest-aborts-post-on-ie-9\n\n    xdr.timeout = this.timeout || 5000; // XDR needs a timeout value or it breaks in IE9\n\n    xdr.onerror = this._boundXhrOnError;\n    xdr.ontimeout = this._boundXhrOnTimeout;\n    xdr.onprogress = this._boundOnProgress;\n    xdr.onload = this._boundXhrOnLoad;\n    xdr.open('GET', this.url, true); // Note: The xdr.send() call is wrapped in a timeout to prevent an\n    // issue with the interface where some requests are lost if multiple\n    // XDomainRequests are being sent at the same time.\n    // Some info here: https://github.com/photonstorm/phaser/issues/1248\n\n    setTimeout(function () {\n      return xdr.send();\n    }, 1);\n  }\n  /**\n   * Creates a source used in loading via an element.\n   *\n   * @private\n   * @param {string} type - The element type (video or audio).\n   * @param {string} url - The source URL to load from.\n   * @param {string} [mime] - The mime type of the video\n   * @return {HTMLSourceElement} The source element.\n   */\n  ;\n\n  _proto._createSource = function _createSource(type, url, mime) {\n    if (!mime) {\n      mime = type + \"/\" + this._getExtension(url);\n    }\n\n    var source = document.createElement('source');\n    source.src = url;\n    source.type = mime;\n    return source;\n  }\n  /**\n   * Called if a load errors out.\n   *\n   * @param {Event} event - The error event from the element that emits it.\n   * @private\n   */\n  ;\n\n  _proto._onError = function _onError(event) {\n    this.abort(\"Failed to load element using: \" + event.target.nodeName);\n  }\n  /**\n   * Called if a load progress event fires for an element or xhr/xdr.\n   *\n   * @private\n   * @param {XMLHttpRequestProgressEvent|Event} event - Progress event.\n   */\n  ;\n\n  _proto._onProgress = function _onProgress(event) {\n    if (event && event.lengthComputable) {\n      this.onProgress.dispatch(this, event.loaded / event.total);\n    }\n  }\n  /**\n   * Called if a timeout event fires for an element.\n   *\n   * @private\n   */\n  ;\n\n  _proto._onTimeout = function _onTimeout() {\n    this.abort(\"Load timed out.\");\n  }\n  /**\n   * Called if an error event fires for xhr/xdr.\n   *\n   * @private\n   */\n  ;\n\n  _proto._xhrOnError = function _xhrOnError() {\n    var xhr = this.xhr;\n    this.abort(reqType(xhr) + \" Request failed. Status: \" + xhr.status + \", text: \\\"\" + xhr.statusText + \"\\\"\");\n  }\n  /**\n   * Called if an error event fires for xhr/xdr.\n   *\n   * @private\n   */\n  ;\n\n  _proto._xhrOnTimeout = function _xhrOnTimeout() {\n    var xhr = this.xhr;\n    this.abort(reqType(xhr) + \" Request timed out.\");\n  }\n  /**\n   * Called if an abort event fires for xhr/xdr.\n   *\n   * @private\n   */\n  ;\n\n  _proto._xhrOnAbort = function _xhrOnAbort() {\n    var xhr = this.xhr;\n    this.abort(reqType(xhr) + \" Request was aborted by the user.\");\n  }\n  /**\n   * Called when data successfully loads from an xhr/xdr request.\n   *\n   * @private\n   * @param {XMLHttpRequestLoadEvent|Event} event - Load event\n   */\n  ;\n\n  _proto._xhrOnLoad = function _xhrOnLoad() {\n    var xhr = this.xhr;\n    var text = '';\n    var status = typeof xhr.status === 'undefined' ? STATUS_OK : xhr.status; // XDR has no `.status`, assume 200.\n    // responseText is accessible only if responseType is '' or 'text' and on older browsers\n\n    if (xhr.responseType === '' || xhr.responseType === 'text' || typeof xhr.responseType === 'undefined') {\n      text = xhr.responseText;\n    } // status can be 0 when using the `file://` protocol so we also check if a response is set.\n    // If it has a response, we assume 200; otherwise a 0 status code with no contents is an aborted request.\n\n\n    if (status === STATUS_NONE && (text.length > 0 || xhr.responseType === Resource.XHR_RESPONSE_TYPE.BUFFER)) {\n      status = STATUS_OK;\n    } // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n    else if (status === STATUS_IE_BUG_EMPTY) {\n        status = STATUS_EMPTY;\n      }\n\n    var statusType = status / 100 | 0;\n\n    if (statusType === STATUS_TYPE_OK) {\n      // if text, just return it\n      if (this.xhrType === Resource.XHR_RESPONSE_TYPE.TEXT) {\n        this.data = text;\n        this.type = Resource.TYPE.TEXT;\n      } // if json, parse into json object\n      else if (this.xhrType === Resource.XHR_RESPONSE_TYPE.JSON) {\n          try {\n            this.data = JSON.parse(text);\n            this.type = Resource.TYPE.JSON;\n          } catch (e) {\n            this.abort(\"Error trying to parse loaded json: \" + e);\n            return;\n          }\n        } // if xml, parse into an xml document or div element\n        else if (this.xhrType === Resource.XHR_RESPONSE_TYPE.DOCUMENT) {\n            try {\n              if (window.DOMParser) {\n                var domparser = new DOMParser();\n                this.data = domparser.parseFromString(text, 'text/xml');\n              } else {\n                var div = document.createElement('div');\n                div.innerHTML = text;\n                this.data = div;\n              }\n\n              this.type = Resource.TYPE.XML;\n            } catch (e) {\n              this.abort(\"Error trying to parse loaded xml: \" + e);\n              return;\n            }\n          } // other types just return the response\n          else {\n              this.data = xhr.response || text;\n            }\n    } else {\n      this.abort(\"[\" + xhr.status + \"] \" + xhr.statusText + \": \" + xhr.responseURL);\n      return;\n    }\n\n    this.complete();\n  }\n  /**\n   * Sets the `crossOrigin` property for this resource based on if the url\n   * for this resource is cross-origin. If crossOrigin was manually set, this\n   * function does nothing.\n   *\n   * @private\n   * @param {string} url - The url to test.\n   * @param {object} [loc=window.location] - The location object to test against.\n   * @return {string} The crossOrigin value to use (or empty string for none).\n   */\n  ;\n\n  _proto._determineCrossOrigin = function _determineCrossOrigin(url, loc) {\n    // data: and javascript: urls are considered same-origin\n    if (url.indexOf('data:') === 0) {\n      return '';\n    } // A sandboxed iframe without the 'allow-same-origin' attribute will have a special\n    // origin designed not to match window.location.origin, and will always require\n    // crossOrigin requests regardless of whether the location matches.\n\n\n    if (window.origin !== window.location.origin) {\n      return 'anonymous';\n    } // default is window.location\n\n\n    loc = loc || window.location;\n\n    if (!tempAnchor) {\n      tempAnchor = document.createElement('a');\n    } // let the browser determine the full href for the url of this resource and then\n    // parse with the node url lib, we can't use the properties of the anchor element\n    // because they don't work in IE9 :(\n\n\n    tempAnchor.href = url;\n    url = parseUri(tempAnchor.href, {\n      strictMode: true\n    });\n    var samePort = !url.port && loc.port === '' || url.port === loc.port;\n    var protocol = url.protocol ? url.protocol + \":\" : ''; // if cross origin\n\n    if (url.host !== loc.hostname || !samePort || protocol !== loc.protocol) {\n      return 'anonymous';\n    }\n\n    return '';\n  }\n  /**\n   * Determines the responseType of an XHR request based on the extension of the\n   * resource being loaded.\n   *\n   * @private\n   * @return {Resource.XHR_RESPONSE_TYPE} The responseType to use.\n   */\n  ;\n\n  _proto._determineXhrType = function _determineXhrType() {\n    return Resource._xhrTypeMap[this.extension] || Resource.XHR_RESPONSE_TYPE.TEXT;\n  }\n  /**\n   * Determines the loadType of a resource based on the extension of the\n   * resource being loaded.\n   *\n   * @private\n   * @return {Resource.LOAD_TYPE} The loadType to use.\n   */\n  ;\n\n  _proto._determineLoadType = function _determineLoadType() {\n    return Resource._loadTypeMap[this.extension] || Resource.LOAD_TYPE.XHR;\n  }\n  /**\n   * Extracts the extension (sans '.') of the file being loaded by the resource.\n   *\n   * @private\n   * @return {string} The extension.\n   */\n  ;\n\n  _proto._getExtension = function _getExtension() {\n    var url = this.url;\n    var ext = '';\n\n    if (this.isDataUrl) {\n      var slashIndex = url.indexOf('/');\n      ext = url.substring(slashIndex + 1, url.indexOf(';', slashIndex));\n    } else {\n      var queryStart = url.indexOf('?');\n      var hashStart = url.indexOf('#');\n      var index = Math.min(queryStart > -1 ? queryStart : url.length, hashStart > -1 ? hashStart : url.length);\n      url = url.substring(0, index);\n      ext = url.substring(url.lastIndexOf('.') + 1);\n    }\n\n    return ext.toLowerCase();\n  }\n  /**\n   * Determines the mime type of an XHR request based on the responseType of\n   * resource being loaded.\n   *\n   * @private\n   * @param {Resource.XHR_RESPONSE_TYPE} type - The type to get a mime type for.\n   * @return {string} The mime type to use.\n   */\n  ;\n\n  _proto._getMimeFromXhrType = function _getMimeFromXhrType(type) {\n    switch (type) {\n      case Resource.XHR_RESPONSE_TYPE.BUFFER:\n        return 'application/octet-binary';\n\n      case Resource.XHR_RESPONSE_TYPE.BLOB:\n        return 'application/blob';\n\n      case Resource.XHR_RESPONSE_TYPE.DOCUMENT:\n        return 'application/xml';\n\n      case Resource.XHR_RESPONSE_TYPE.JSON:\n        return 'application/json';\n\n      case Resource.XHR_RESPONSE_TYPE.DEFAULT:\n      case Resource.XHR_RESPONSE_TYPE.TEXT:\n      /* falls through */\n\n      default:\n        return 'text/plain';\n    }\n  };\n\n  _createClass(Resource, [{\n    key: \"isDataUrl\",\n    get: function get() {\n      return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL);\n    }\n    /**\n     * Describes if this resource has finished loading. Is true when the resource has completely\n     * loaded.\n     *\n     * @readonly\n     * @member {boolean}\n     */\n\n  }, {\n    key: \"isComplete\",\n    get: function get() {\n      return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE);\n    }\n    /**\n     * Describes if this resource is currently loading. Is true when the resource starts loading,\n     * and is false again when complete.\n     *\n     * @readonly\n     * @member {boolean}\n     */\n\n  }, {\n    key: \"isLoading\",\n    get: function get() {\n      return this._hasFlag(Resource.STATUS_FLAGS.LOADING);\n    }\n  }]);\n\n  return Resource;\n}();\n/**\n * The types of resources a resource could represent.\n *\n * @static\n * @readonly\n * @enum {number}\n */\n\n\nResource.STATUS_FLAGS = {\n  NONE: 0,\n  DATA_URL: 1 << 0,\n  COMPLETE: 1 << 1,\n  LOADING: 1 << 2\n};\n/**\n * The types of resources a resource could represent.\n *\n * @static\n * @readonly\n * @enum {number}\n */\n\nResource.TYPE = {\n  UNKNOWN: 0,\n  JSON: 1,\n  XML: 2,\n  IMAGE: 3,\n  AUDIO: 4,\n  VIDEO: 5,\n  TEXT: 6\n};\n/**\n * The types of loading a resource can use.\n *\n * @static\n * @readonly\n * @enum {number}\n */\n\nResource.LOAD_TYPE = {\n  /** Uses XMLHttpRequest to load the resource. */\n  XHR: 1,\n\n  /** Uses an `Image` object to load the resource. */\n  IMAGE: 2,\n\n  /** Uses an `Audio` object to load the resource. */\n  AUDIO: 3,\n\n  /** Uses a `Video` object to load the resource. */\n  VIDEO: 4\n};\n/**\n * The XHR ready states, used internally.\n *\n * @static\n * @readonly\n * @enum {string}\n */\n\nResource.XHR_RESPONSE_TYPE = {\n  /** string */\n  DEFAULT: 'text',\n\n  /** ArrayBuffer */\n  BUFFER: 'arraybuffer',\n\n  /** Blob */\n  BLOB: 'blob',\n\n  /** Document */\n  DOCUMENT: 'document',\n\n  /** Object */\n  JSON: 'json',\n\n  /** String */\n  TEXT: 'text'\n};\nResource._loadTypeMap = {\n  // images\n  gif: Resource.LOAD_TYPE.IMAGE,\n  png: Resource.LOAD_TYPE.IMAGE,\n  bmp: Resource.LOAD_TYPE.IMAGE,\n  jpg: Resource.LOAD_TYPE.IMAGE,\n  jpeg: Resource.LOAD_TYPE.IMAGE,\n  tif: Resource.LOAD_TYPE.IMAGE,\n  tiff: Resource.LOAD_TYPE.IMAGE,\n  webp: Resource.LOAD_TYPE.IMAGE,\n  tga: Resource.LOAD_TYPE.IMAGE,\n  svg: Resource.LOAD_TYPE.IMAGE,\n  'svg+xml': Resource.LOAD_TYPE.IMAGE,\n  // for SVG data urls\n  // audio\n  mp3: Resource.LOAD_TYPE.AUDIO,\n  ogg: Resource.LOAD_TYPE.AUDIO,\n  wav: Resource.LOAD_TYPE.AUDIO,\n  // videos\n  mp4: Resource.LOAD_TYPE.VIDEO,\n  webm: Resource.LOAD_TYPE.VIDEO\n};\nResource._xhrTypeMap = {\n  // xml\n  xhtml: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  html: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  htm: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  xml: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  tmx: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  svg: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  // This was added to handle Tiled Tileset XML, but .tsx is also a TypeScript React Component.\n  // Since it is way less likely for people to be loading TypeScript files instead of Tiled files,\n  // this should probably be fine.\n  tsx: Resource.XHR_RESPONSE_TYPE.DOCUMENT,\n  // images\n  gif: Resource.XHR_RESPONSE_TYPE.BLOB,\n  png: Resource.XHR_RESPONSE_TYPE.BLOB,\n  bmp: Resource.XHR_RESPONSE_TYPE.BLOB,\n  jpg: Resource.XHR_RESPONSE_TYPE.BLOB,\n  jpeg: Resource.XHR_RESPONSE_TYPE.BLOB,\n  tif: Resource.XHR_RESPONSE_TYPE.BLOB,\n  tiff: Resource.XHR_RESPONSE_TYPE.BLOB,\n  webp: Resource.XHR_RESPONSE_TYPE.BLOB,\n  tga: Resource.XHR_RESPONSE_TYPE.BLOB,\n  // json\n  json: Resource.XHR_RESPONSE_TYPE.JSON,\n  // text\n  text: Resource.XHR_RESPONSE_TYPE.TEXT,\n  txt: Resource.XHR_RESPONSE_TYPE.TEXT,\n  // fonts\n  ttf: Resource.XHR_RESPONSE_TYPE.BUFFER,\n  otf: Resource.XHR_RESPONSE_TYPE.BUFFER\n}; // We can't set the `src` attribute to empty string, so on abort we set it to this 1px transparent gif\n\nResource.EMPTY_GIF = 'data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==';\n/**\n * Quick helper to set a value on one of the extension maps. Ensures there is no\n * dot at the start of the extension.\n *\n * @ignore\n * @param {object} map - The map to set on.\n * @param {string} extname - The extension (or key) to set.\n * @param {number} val - The value to set.\n */\n\nfunction setExtMap(map, extname, val) {\n  if (extname && extname.indexOf('.') === 0) {\n    extname = extname.substring(1);\n  }\n\n  if (!extname) {\n    return;\n  }\n\n  map[extname] = val;\n}\n/**\n * Quick helper to get string xhr type.\n *\n * @ignore\n * @param {XMLHttpRequest|XDomainRequest} xhr - The request to check.\n * @return {string} The type.\n */\n\n\nfunction reqType(xhr) {\n  return xhr.toString().replace('object ', '');\n}\n\nvar _keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n/**\n * Encodes binary into base64.\n *\n * @function encodeBinary\n * @param {string} input The input data to encode.\n * @returns {string} The encoded base64 string\n */\n\nfunction encodeBinary(input) {\n  var output = '';\n  var inx = 0;\n\n  while (inx < input.length) {\n    // Fill byte buffer array\n    var bytebuffer = [0, 0, 0];\n    var encodedCharIndexes = [0, 0, 0, 0];\n\n    for (var jnx = 0; jnx < bytebuffer.length; ++jnx) {\n      if (inx < input.length) {\n        // throw away high-order byte, as documented at:\n        // https://developer.mozilla.org/En/Using_XMLHttpRequest#Handling_binary_data\n        bytebuffer[jnx] = input.charCodeAt(inx++) & 0xff;\n      } else {\n        bytebuffer[jnx] = 0;\n      }\n    } // Get each encoded character, 6 bits at a time\n    // index 1: first 6 bits\n\n\n    encodedCharIndexes[0] = bytebuffer[0] >> 2; // index 2: second 6 bits (2 least significant bits from input byte 1 + 4 most significant bits from byte 2)\n\n    encodedCharIndexes[1] = (bytebuffer[0] & 0x3) << 4 | bytebuffer[1] >> 4; // index 3: third 6 bits (4 least significant bits from input byte 2 + 2 most significant bits from byte 3)\n\n    encodedCharIndexes[2] = (bytebuffer[1] & 0x0f) << 2 | bytebuffer[2] >> 6; // index 3: forth 6 bits (6 least significant bits from input byte 3)\n\n    encodedCharIndexes[3] = bytebuffer[2] & 0x3f; // Determine whether padding happened, and adjust accordingly\n\n    var paddingBytes = inx - (input.length - 1);\n\n    switch (paddingBytes) {\n      case 2:\n        // Set last 2 characters to padding char\n        encodedCharIndexes[3] = 64;\n        encodedCharIndexes[2] = 64;\n        break;\n\n      case 1:\n        // Set last character to padding char\n        encodedCharIndexes[3] = 64;\n        break;\n\n      default:\n        break;\n      // No padding - proceed\n    } // Now we will grab each appropriate character out of our keystring\n    // based on our index array and append it to the output string\n\n\n    for (var _jnx = 0; _jnx < encodedCharIndexes.length; ++_jnx) {\n      output += _keyStr.charAt(encodedCharIndexes[_jnx]);\n    }\n  }\n\n  return output;\n}\n\nvar Url = window.URL || window.webkitURL;\n/**\n * A middleware for transforming XHR loaded Blobs into more useful objects\n *\n * @memberof middleware\n * @function parsing\n * @example\n * import { Loader, middleware } from 'resource-loader';\n * const loader = new Loader();\n * loader.use(middleware.parsing);\n * @param {Resource} resource - Current Resource\n * @param {function} next - Callback when complete\n */\n\nfunction parsing(resource, next) {\n  if (!resource.data) {\n    next();\n    return;\n  } // if this was an XHR load of a blob\n\n\n  if (resource.xhr && resource.xhrType === Resource.XHR_RESPONSE_TYPE.BLOB) {\n    // if there is no blob support we probably got a binary string back\n    if (!window.Blob || typeof resource.data === 'string') {\n      var type = resource.xhr.getResponseHeader('content-type'); // this is an image, convert the binary string into a data url\n\n      if (type && type.indexOf('image') === 0) {\n        resource.data = new Image();\n        resource.data.src = \"data:\" + type + \";base64,\" + encodeBinary(resource.xhr.responseText);\n        resource.type = Resource.TYPE.IMAGE; // wait until the image loads and then callback\n\n        resource.data.onload = function () {\n          resource.data.onload = null;\n          next();\n        }; // next will be called on load\n\n\n        return;\n      }\n    } // if content type says this is an image, then we should transform the blob into an Image object\n    else if (resource.data.type.indexOf('image') === 0) {\n        var src = Url.createObjectURL(resource.data);\n        resource.blob = resource.data;\n        resource.data = new Image();\n        resource.data.src = src;\n        resource.type = Resource.TYPE.IMAGE; // cleanup the no longer used blob after the image loads\n        // TODO: Is this correct? Will the image be invalid after revoking?\n\n        resource.data.onload = function () {\n          Url.revokeObjectURL(src);\n          resource.data.onload = null;\n          next();\n        }; // next will be called on load.\n\n\n        return;\n      }\n  }\n\n  next();\n}\n\n/**\n * @namespace middleware\n */\n\nvar index = ({\n    caching: caching,\n    parsing: parsing\n});\n\nvar MAX_PROGRESS = 100;\nvar rgxExtractUrlHash = /(#[\\w-]+)?$/;\n/**\n * Manages the state and loading of multiple resources to load.\n *\n * @class\n */\n\nvar Loader =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {string} [baseUrl=''] - The base url for all resources loaded by this loader.\n   * @param {number} [concurrency=10] - The number of resources to load concurrently.\n   */\n  function Loader(baseUrl, concurrency) {\n    var _this = this;\n\n    if (baseUrl === void 0) {\n      baseUrl = '';\n    }\n\n    if (concurrency === void 0) {\n      concurrency = 10;\n    }\n\n    /**\n     * The base url for all resources loaded by this loader.\n     *\n     * @member {string}\n     */\n    this.baseUrl = baseUrl;\n    /**\n     * The progress percent of the loader going through the queue.\n     *\n     * @member {number}\n     * @default 0\n     */\n\n    this.progress = 0;\n    /**\n     * Loading state of the loader, true if it is currently loading resources.\n     *\n     * @member {boolean}\n     * @default false\n     */\n\n    this.loading = false;\n    /**\n     * A querystring to append to every URL added to the loader.\n     *\n     * This should be a valid query string *without* the question-mark (`?`). The loader will\n     * also *not* escape values for you. Make sure to escape your parameters with\n     * [`encodeURIComponent`](https://mdn.io/encodeURIComponent) before assigning this property.\n     *\n     * @example\n     * const loader = new Loader();\n     *\n     * loader.defaultQueryString = 'user=me&password=secret';\n     *\n     * // This will request 'image.png?user=me&password=secret'\n     * loader.add('image.png').load();\n     *\n     * loader.reset();\n     *\n     * // This will request 'image.png?v=1&user=me&password=secret'\n     * loader.add('iamge.png?v=1').load();\n     *\n     * @member {string}\n     * @default ''\n     */\n\n    this.defaultQueryString = '';\n    /**\n     * The middleware to run before loading each resource.\n     *\n     * @private\n     * @member {function[]}\n     */\n\n    this._beforeMiddleware = [];\n    /**\n     * The middleware to run after loading each resource.\n     *\n     * @private\n     * @member {function[]}\n     */\n\n    this._afterMiddleware = [];\n    /**\n     * The tracks the resources we are currently completing parsing for.\n     *\n     * @private\n     * @member {Resource[]}\n     */\n\n    this._resourcesParsing = [];\n    /**\n     * The `_loadResource` function bound with this object context.\n     *\n     * @private\n     * @member {function}\n     * @param {Resource} r - The resource to load\n     * @param {Function} d - The dequeue function\n     * @return {undefined}\n     */\n\n    this._boundLoadResource = function (r, d) {\n      return _this._loadResource(r, d);\n    };\n    /**\n     * The resources waiting to be loaded.\n     *\n     * @private\n     * @member {Resource[]}\n     */\n\n\n    this._queue = queue(this._boundLoadResource, concurrency);\n\n    this._queue.pause();\n    /**\n     * All the resources for this loader keyed by name.\n     *\n     * @member {object<string, Resource>}\n     */\n\n\n    this.resources = {};\n    /**\n     * Dispatched once per loaded or errored resource.\n     *\n     * The callback looks like {@link Loader.OnProgressSignal}.\n     *\n     * @member {Signal<Loader.OnProgressSignal>}\n     */\n\n    this.onProgress = new Signal();\n    /**\n     * Dispatched once per errored resource.\n     *\n     * The callback looks like {@link Loader.OnErrorSignal}.\n     *\n     * @member {Signal<Loader.OnErrorSignal>}\n     */\n\n    this.onError = new Signal();\n    /**\n     * Dispatched once per loaded resource.\n     *\n     * The callback looks like {@link Loader.OnLoadSignal}.\n     *\n     * @member {Signal<Loader.OnLoadSignal>}\n     */\n\n    this.onLoad = new Signal();\n    /**\n     * Dispatched when the loader begins to process the queue.\n     *\n     * The callback looks like {@link Loader.OnStartSignal}.\n     *\n     * @member {Signal<Loader.OnStartSignal>}\n     */\n\n    this.onStart = new Signal();\n    /**\n     * Dispatched when the queued resources all load.\n     *\n     * The callback looks like {@link Loader.OnCompleteSignal}.\n     *\n     * @member {Signal<Loader.OnCompleteSignal>}\n     */\n\n    this.onComplete = new Signal(); // Add default before middleware\n\n    for (var i = 0; i < Loader._defaultBeforeMiddleware.length; ++i) {\n      this.pre(Loader._defaultBeforeMiddleware[i]);\n    } // Add default after middleware\n\n\n    for (var _i = 0; _i < Loader._defaultAfterMiddleware.length; ++_i) {\n      this.use(Loader._defaultAfterMiddleware[_i]);\n    }\n  }\n  /**\n   * When the progress changes the loader and resource are disaptched.\n   *\n   * @memberof Loader\n   * @callback OnProgressSignal\n   * @param {Loader} loader - The loader the progress is advancing on.\n   * @param {Resource} resource - The resource that has completed or failed to cause the progress to advance.\n   */\n\n  /**\n   * When an error occurrs the loader and resource are disaptched.\n   *\n   * @memberof Loader\n   * @callback OnErrorSignal\n   * @param {Loader} loader - The loader the error happened in.\n   * @param {Resource} resource - The resource that caused the error.\n   */\n\n  /**\n   * When a load completes the loader and resource are disaptched.\n   *\n   * @memberof Loader\n   * @callback OnLoadSignal\n   * @param {Loader} loader - The loader that laoded the resource.\n   * @param {Resource} resource - The resource that has completed loading.\n   */\n\n  /**\n   * When the loader starts loading resources it dispatches this callback.\n   *\n   * @memberof Loader\n   * @callback OnStartSignal\n   * @param {Loader} loader - The loader that has started loading resources.\n   */\n\n  /**\n   * When the loader completes loading resources it dispatches this callback.\n   *\n   * @memberof Loader\n   * @callback OnCompleteSignal\n   * @param {Loader} loader - The loader that has finished loading resources.\n   */\n\n  /**\n   * Options for a call to `.add()`.\n   *\n   * @see Loader#add\n   *\n   * @typedef {object} IAddOptions\n   * @property {string} [name] - The name of the resource to load, if not passed the url is used.\n   * @property {string} [key] - Alias for `name`.\n   * @property {string} [url] - The url for this resource, relative to the baseUrl of this loader.\n   * @property {string|boolean} [crossOrigin] - Is this request cross-origin? Default is to\n   *      determine automatically.\n   * @property {number} [timeout=0] - A timeout in milliseconds for the load. If the load takes\n   *      longer than this time it is cancelled and the load is considered a failure. If this value is\n   *      set to `0` then there is no explicit timeout.\n   * @property {Resource.LOAD_TYPE} [loadType=Resource.LOAD_TYPE.XHR] - How should this resource\n   *      be loaded?\n   * @property {Resource.XHR_RESPONSE_TYPE} [xhrType=Resource.XHR_RESPONSE_TYPE.DEFAULT] - How\n   *      should the data being loaded be interpreted when using XHR?\n   * @property {Resource.OnCompleteSignal} [onComplete] - Callback to add an an onComplete signal istener.\n   * @property {Resource.OnCompleteSignal} [callback] - Alias for `onComplete`.\n   * @property {Resource.IMetadata} [metadata] - Extra configuration for middleware and the Resource object.\n   */\n\n  /* eslint-disable require-jsdoc,valid-jsdoc */\n\n  /**\n   * Adds a resource (or multiple resources) to the loader queue.\n   *\n   * This function can take a wide variety of different parameters. The only thing that is always\n   * required the url to load. All the following will work:\n   *\n   * ```js\n   * loader\n   *     // normal param syntax\n   *     .add('key', 'http://...', function () {})\n   *     .add('http://...', function () {})\n   *     .add('http://...')\n   *\n   *     // object syntax\n   *     .add({\n   *         name: 'key2',\n   *         url: 'http://...'\n   *     }, function () {})\n   *     .add({\n   *         url: 'http://...'\n   *     }, function () {})\n   *     .add({\n   *         name: 'key3',\n   *         url: 'http://...'\n   *         onComplete: function () {}\n   *     })\n   *     .add({\n   *         url: 'https://...',\n   *         onComplete: function () {},\n   *         crossOrigin: true\n   *     })\n   *\n   *     // you can also pass an array of objects or urls or both\n   *     .add([\n   *         { name: 'key4', url: 'http://...', onComplete: function () {} },\n   *         { url: 'http://...', onComplete: function () {} },\n   *         'http://...'\n   *     ])\n   *\n   *     // and you can use both params and options\n   *     .add('key', 'http://...', { crossOrigin: true }, function () {})\n   *     .add('http://...', { crossOrigin: true }, function () {});\n   * ```\n   *\n   * @function\n   * @variation 1\n   * @param {string} name - The name of the resource to load.\n   * @param {string} url - The url for this resource, relative to the baseUrl of this loader.\n   * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n   * @return {this} Returns itself.\n   */\n\n  /**\n  * @function\n  * @variation 2\n  * @param {string} name - The name of the resource to load.\n  * @param {string} url - The url for this resource, relative to the baseUrl of this loader.\n  * @param {IAddOptions} [options] - The options for the load.\n  * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n  * @return {this} Returns itself.\n  */\n\n  /**\n  * @function\n  * @variation 3\n  * @param {string} url - The url for this resource, relative to the baseUrl of this loader.\n  * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n  * @return {this} Returns itself.\n  */\n\n  /**\n  * @function\n  * @variation 4\n  * @param {string} url - The url for this resource, relative to the baseUrl of this loader.\n  * @param {IAddOptions} [options] - The options for the load.\n  * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n  * @return {this} Returns itself.\n  */\n\n  /**\n  * @function\n  * @variation 5\n  * @param {IAddOptions} options - The options for the load. This object must contain a `url` property.\n  * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n  * @return {this} Returns itself.\n  */\n\n  /**\n  * @function\n  * @variation 6\n  * @param {Array<IAddOptions|string>} resources - An array of resources to load, where each is\n  *      either an object with the options or a string url. If you pass an object, it must contain a `url` property.\n  * @param {Resource.OnCompleteSignal} [callback] - Function to call when this specific resource completes loading.\n  * @return {this} Returns itself.\n  */\n\n\n  var _proto = Loader.prototype;\n\n  _proto.add = function add(name, url, options, cb) {\n    // special case of an array of objects or urls\n    if (Array.isArray(name)) {\n      for (var i = 0; i < name.length; ++i) {\n        this.add(name[i]);\n      }\n\n      return this;\n    } // if an object is passed instead of params\n\n\n    if (typeof name === 'object') {\n      cb = url || name.callback || name.onComplete;\n      options = name;\n      url = name.url;\n      name = name.name || name.key || name.url;\n    } // case where no name is passed shift all args over by one.\n\n\n    if (typeof url !== 'string') {\n      cb = options;\n      options = url;\n      url = name;\n    } // now that we shifted make sure we have a proper url.\n\n\n    if (typeof url !== 'string') {\n      throw new Error('No url passed to add resource to loader.');\n    } // options are optional so people might pass a function and no options\n\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = null;\n    } // if loading already you can only add resources that have a parent.\n\n\n    if (this.loading && (!options || !options.parentResource)) {\n      throw new Error('Cannot add resources while the loader is running.');\n    } // check if resource already exists.\n\n\n    if (this.resources[name]) {\n      throw new Error(\"Resource named \\\"\" + name + \"\\\" already exists.\");\n    } // add base url if this isn't an absolute url\n\n\n    url = this._prepareUrl(url); // create the store the resource\n\n    this.resources[name] = new Resource(name, url, options);\n\n    if (typeof cb === 'function') {\n      this.resources[name].onAfterMiddleware.once(cb);\n    } // if actively loading, make sure to adjust progress chunks for that parent and its children\n\n\n    if (this.loading) {\n      var parent = options.parentResource;\n      var incompleteChildren = [];\n\n      for (var _i2 = 0; _i2 < parent.children.length; ++_i2) {\n        if (!parent.children[_i2].isComplete) {\n          incompleteChildren.push(parent.children[_i2]);\n        }\n      }\n\n      var fullChunk = parent.progressChunk * (incompleteChildren.length + 1); // +1 for parent\n\n      var eachChunk = fullChunk / (incompleteChildren.length + 2); // +2 for parent & new child\n\n      parent.children.push(this.resources[name]);\n      parent.progressChunk = eachChunk;\n\n      for (var _i3 = 0; _i3 < incompleteChildren.length; ++_i3) {\n        incompleteChildren[_i3].progressChunk = eachChunk;\n      }\n\n      this.resources[name].progressChunk = eachChunk;\n    } // add the resource to the queue\n\n\n    this._queue.push(this.resources[name]);\n\n    return this;\n  }\n  /* eslint-enable require-jsdoc,valid-jsdoc */\n\n  /**\n   * Sets up a middleware function that will run *before* the\n   * resource is loaded.\n   *\n   * @param {function} fn - The middleware function to register.\n   * @return {this} Returns itself.\n   */\n  ;\n\n  _proto.pre = function pre(fn) {\n    this._beforeMiddleware.push(fn);\n\n    return this;\n  }\n  /**\n   * Sets up a middleware function that will run *after* the\n   * resource is loaded.\n   *\n   * @param {function} fn - The middleware function to register.\n   * @return {this} Returns itself.\n   */\n  ;\n\n  _proto.use = function use(fn) {\n    this._afterMiddleware.push(fn);\n\n    return this;\n  }\n  /**\n   * Resets the queue of the loader to prepare for a new load.\n   *\n   * @return {this} Returns itself.\n   */\n  ;\n\n  _proto.reset = function reset() {\n    this.progress = 0;\n    this.loading = false;\n\n    this._queue.kill();\n\n    this._queue.pause(); // abort all resource loads\n\n\n    for (var k in this.resources) {\n      var res = this.resources[k];\n\n      if (res._onLoadBinding) {\n        res._onLoadBinding.detach();\n      }\n\n      if (res.isLoading) {\n        res.abort();\n      }\n    }\n\n    this.resources = {};\n    return this;\n  }\n  /**\n   * Starts loading the queued resources.\n   *\n   * @param {function} [cb] - Optional callback that will be bound to the `complete` event.\n   * @return {this} Returns itself.\n   */\n  ;\n\n  _proto.load = function load(cb) {\n    // register complete callback if they pass one\n    if (typeof cb === 'function') {\n      this.onComplete.once(cb);\n    } // if the queue has already started we are done here\n\n\n    if (this.loading) {\n      return this;\n    }\n\n    if (this._queue.idle()) {\n      this._onStart();\n\n      this._onComplete();\n    } else {\n      // distribute progress chunks\n      var numTasks = this._queue._tasks.length;\n      var chunk = MAX_PROGRESS / numTasks;\n\n      for (var i = 0; i < this._queue._tasks.length; ++i) {\n        this._queue._tasks[i].data.progressChunk = chunk;\n      } // notify we are starting\n\n\n      this._onStart(); // start loading\n\n\n      this._queue.resume();\n    }\n\n    return this;\n  }\n  /**\n   * The number of resources to load concurrently.\n   *\n   * @member {number}\n   * @default 10\n   */\n  ;\n\n  /**\n   * Prepares a url for usage based on the configuration of this object\n   *\n   * @private\n   * @param {string} url - The url to prepare.\n   * @return {string} The prepared url.\n   */\n  _proto._prepareUrl = function _prepareUrl(url) {\n    var parsedUrl = parseUri(url, {\n      strictMode: true\n    });\n    var result; // absolute url, just use it as is.\n\n    if (parsedUrl.protocol || !parsedUrl.path || url.indexOf('//') === 0) {\n      result = url;\n    } // if baseUrl doesn't end in slash and url doesn't start with slash, then add a slash inbetween\n    else if (this.baseUrl.length && this.baseUrl.lastIndexOf('/') !== this.baseUrl.length - 1 && url.charAt(0) !== '/') {\n        result = this.baseUrl + \"/\" + url;\n      } else {\n        result = this.baseUrl + url;\n      } // if we need to add a default querystring, there is a bit more work\n\n\n    if (this.defaultQueryString) {\n      var hash = rgxExtractUrlHash.exec(result)[0];\n      result = result.substr(0, result.length - hash.length);\n\n      if (result.indexOf('?') !== -1) {\n        result += \"&\" + this.defaultQueryString;\n      } else {\n        result += \"?\" + this.defaultQueryString;\n      }\n\n      result += hash;\n    }\n\n    return result;\n  }\n  /**\n   * Loads a single resource.\n   *\n   * @private\n   * @param {Resource} resource - The resource to load.\n   * @param {function} dequeue - The function to call when we need to dequeue this item.\n   */\n  ;\n\n  _proto._loadResource = function _loadResource(resource, dequeue) {\n    var _this2 = this;\n\n    resource._dequeue = dequeue; // run before middleware\n\n    eachSeries(this._beforeMiddleware, function (fn, next) {\n      fn.call(_this2, resource, function () {\n        // if the before middleware marks the resource as complete,\n        // break and don't process any more before middleware\n        next(resource.isComplete ? {} : null);\n      });\n    }, function () {\n      if (resource.isComplete) {\n        _this2._onLoad(resource);\n      } else {\n        resource._onLoadBinding = resource.onComplete.once(_this2._onLoad, _this2);\n        resource.load();\n      }\n    }, true);\n  }\n  /**\n   * Called once loading has started.\n   *\n   * @private\n   */\n  ;\n\n  _proto._onStart = function _onStart() {\n    this.progress = 0;\n    this.loading = true;\n    this.onStart.dispatch(this);\n  }\n  /**\n   * Called once each resource has loaded.\n   *\n   * @private\n   */\n  ;\n\n  _proto._onComplete = function _onComplete() {\n    this.progress = MAX_PROGRESS;\n    this.loading = false;\n    this.onComplete.dispatch(this, this.resources);\n  }\n  /**\n   * Called each time a resources is loaded.\n   *\n   * @private\n   * @param {Resource} resource - The resource that was loaded\n   */\n  ;\n\n  _proto._onLoad = function _onLoad(resource) {\n    var _this3 = this;\n\n    resource._onLoadBinding = null; // remove this resource from the async queue, and add it to our list of resources that are being parsed\n\n    this._resourcesParsing.push(resource);\n\n    resource._dequeue(); // run all the after middleware for this resource\n\n\n    eachSeries(this._afterMiddleware, function (fn, next) {\n      fn.call(_this3, resource, next);\n    }, function () {\n      resource.onAfterMiddleware.dispatch(resource);\n      _this3.progress = Math.min(MAX_PROGRESS, _this3.progress + resource.progressChunk);\n\n      _this3.onProgress.dispatch(_this3, resource);\n\n      if (resource.error) {\n        _this3.onError.dispatch(resource.error, _this3, resource);\n      } else {\n        _this3.onLoad.dispatch(_this3, resource);\n      }\n\n      _this3._resourcesParsing.splice(_this3._resourcesParsing.indexOf(resource), 1); // do completion check\n\n\n      if (_this3._queue.idle() && _this3._resourcesParsing.length === 0) {\n        _this3._onComplete();\n      }\n    }, true);\n  };\n\n  _createClass(Loader, [{\n    key: \"concurrency\",\n    get: function get() {\n      return this._queue.concurrency;\n    } // eslint-disable-next-line require-jsdoc\n    ,\n    set: function set(concurrency) {\n      this._queue.concurrency = concurrency;\n    }\n  }]);\n\n  return Loader;\n}();\n/**\n * A default array of middleware to run before loading each resource.\n * Each of these middlewares are added to any new Loader instances when they are created.\n *\n * @private\n * @member {function[]}\n */\n\n\nLoader._defaultBeforeMiddleware = [];\n/**\n * A default array of middleware to run after loading each resource.\n * Each of these middlewares are added to any new Loader instances when they are created.\n *\n * @private\n * @member {function[]}\n */\n\nLoader._defaultAfterMiddleware = [];\n/**\n * Sets up a middleware function that will run *before* the\n * resource is loaded.\n *\n * @static\n * @param {function} fn - The middleware function to register.\n * @return {Loader} Returns itself.\n */\n\nLoader.pre = function LoaderPreStatic(fn) {\n  Loader._defaultBeforeMiddleware.push(fn);\n\n  return Loader;\n};\n/**\n * Sets up a middleware function that will run *after* the\n * resource is loaded.\n *\n * @static\n * @param {function} fn - The middleware function to register.\n * @return {Loader} Returns itself.\n */\n\n\nLoader.use = function LoaderUseStatic(fn) {\n  Loader._defaultAfterMiddleware.push(fn);\n\n  return Loader;\n};\n\nexport { Loader, Resource, async, encodeBinary, index as middleware };\n//# sourceMappingURL=resource-loader.esm.js.map\n"],"names":["_noop","eachSeries","array","iterator","callback","deferNext","i","len","length","next","err","setTimeout","onlyOnce","fn","Error","callFn","apply","this","arguments","cache","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","useXdr","window","XDomainRequest","XMLHttpRequest","tempAnchor","_noop$1","Resource","name","url","options","_flags","_setFlag","STATUS_FLAGS","DATA_URL","indexOf","extension","_getExtension","data","crossOrigin","timeout","loadType","_determineLoadType","xhrType","metadata","error","xhr","children","type","TYPE","UNKNOWN","progressChunk","_dequeue","_onLoadBinding","_elementTimer","_boundComplete","complete","bind","_boundOnError","_onError","_boundOnProgress","_onProgress","_boundOnTimeout","_onTimeout","_boundXhrOnError","_xhrOnError","_boundXhrOnTimeout","_xhrOnTimeout","_boundXhrOnAbort","_xhrOnAbort","_boundXhrOnLoad","_xhrOnLoad","onStart","onProgress","onComplete","onAfterMiddleware","setExtensionLoadType","extname","setExtMap","_loadTypeMap","setExtensionXhrType","_xhrTypeMap","_proto","_clearEvents","_finish","abort","message","xdr","src","EMPTY_GIF","firstChild","removeChild","load","cb","_this","isLoading","isComplete","once","LOADING","dispatch","_determineCrossOrigin","LOAD_TYPE","IMAGE","_loadElement","AUDIO","_loadSourceElement","VIDEO","XHR","_loadXdr","_loadXhr","_hasFlag","flag","value","clearTimeout","removeEventListener","onerror","ontimeout","onprogress","onload","COMPLETE","loadElement","Image","document","createElement","skipSource","addEventListener","Audio","navigator","isCocoonJS","Array","isArray","mimeTypes","mimeType","appendChild","_createSource","_mimeTypes","_determineXhrType","open","XHR_RESPONSE_TYPE","JSON","DOCUMENT","responseType","TEXT","send","mime","source","event","nodeName","lengthComputable","loaded","total","reqType","status","statusText","text","responseText","BUFFER","parse","e","DOMParser","domparser","parseFromString","div","innerHTML","XML","response","responseURL","loc","origin","location","href","samePort","strictMode","port","protocol","host","hostname","ext","isDataUrl","slashIndex","substring","queryStart","hashStart","index","Math","min","lastIndexOf","toLowerCase","_getMimeFromXhrType","BLOB","DEFAULT","get","map","val","toString","replace","NONE","gif","png","bmp","jpg","jpeg","tif","tiff","webp","tga","svg","mp3","ogg","wav","mp4","webm","xhtml","html","htm","xml","tmx","tsx","json","txt","ttf","otf","Url","URL","webkitURL","caching","resource","parsing","Blob","createObjectURL","blob","revokeObjectURL","getResponseHeader","input","output","inx","bytebuffer","encodedCharIndexes","jnx","charCodeAt","_jnx","charAt","encodeBinary","rgxExtractUrlHash","Loader","baseUrl","concurrency","progress","loading","defaultQueryString","_beforeMiddleware","_afterMiddleware","_resourcesParsing","_boundLoadResource","r","d","_loadResource","_queue","worker","workers","q","_tasks","saturated","unsaturated","buffer","empty","drain","started","paused","push","_insert","kill","unshift","process","task","shift","_next","running","idle","pause","resume","w","insertAtFront","item","queue","resources","onError","onLoad","_defaultBeforeMiddleware","pre","_i","_defaultAfterMiddleware","use","add","parentResource","_prepareUrl","parent","incompleteChildren","_i2","eachChunk","_i3","reset","k","res","detach","_onStart","_onComplete","chunk","result","parsedUrl","path","hash","exec","substr","dequeue","_this2","call","_onLoad","_this3","splice","set"],"sourceRoot":""}