/*! For license information please see 27c3320b14f71ce81bf4.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1385],{7228:(t,e,i)=>{i.d(e,{Zq:()=>x,fh:()=>l,B9:()=>_,FI:()=>T});var r=i(5880),n=i(6469),o=i(5524),s=i(8762),u=i(2754),h=i(6658);r.X.UPLOADS_PER_FRAME=4;var a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},a(t,e)},l=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function f(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof n.xE){var o=t._textures[r].baseTexture;-1===e.indexOf(o)&&(e.push(o),i=!0)}return i}function c(t,e){if(t.baseTexture instanceof n.VL){var i=t.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function p(t,e){if(t._texture&&t._texture instanceof n.xE){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function d(t,e){return e instanceof h.xv&&(e.updateText(!0),!0)}function k(t,e){if(e instanceof h.pn){var i=e.toFontString();return h._A.measureFont(i),!0}return!1}function g(t,e){if(t instanceof h.xv){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function m(t,e){return t instanceof h.pn&&(-1===e.indexOf(t)&&e.push(t),!0)}var x=function(){function t(t){var e=this;this.limiter=new l(r.X.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(g),this.registerFindHook(m),this.registerFindHook(f),this.registerFindHook(c),this.registerFindHook(p),this.registerUploadHook(d),this.registerUploadHook(k)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,s.vB.system.addOnce(this.tick,this,s.uF.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)s.vB.system.addOnce(this.tick,this,s.uF.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);for(this.completes.length=0,i=0,r=n.length;i<r;i++)n[i]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof u.W2)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&s.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function y(t,e){return e instanceof n.VL&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function H(t,e){if(!(e instanceof o.TC))return!1;var i=e.geometry;e.finishPoly(),i.updateBatches();for(var r=i.batches,n=0;n<r.length;n++){var s=r[n].style.texture;s&&y(t,s.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader(t)),!0}function v(t,e){return t instanceof o.TC&&(e.push(t),!0)}var _=function(t){function e(e){var i=t.call(this,e)||this;return i.uploadHookHelper=i.renderer,i.registerFindHook(v),i.registerUploadHook(y),i.registerUploadHook(H),i}return function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e}(x),T=function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}()}}]);